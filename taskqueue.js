!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self)["@wt/lib-taskqueue"]=t()}(this,(function(){"use strict";const e=require("pino"),t=require("numeral"),r=e({prettyPrint:{levelFirst:!0,translateTime:"SYS:standard",crlf:!0},prettifier:require("pino-pretty")});function n(e,r,n){let o=e*(n-r)/r;o=Number.parseInt(o);let i=o%1e3;o=Number.parseInt(o/1e3);let a=o%60;o=Number.parseInt(o/60);let l=o%60,u=Number.parseInt(o/24);return`${t(u).format("00")}:${t(l).format("00")}:${t(a).format("00")}.${t(i).format("000")}`}return process.env.LOGGER&&(r.level=process.env.LOGGER),function(e,t=20,o="默认任务队列"){let i=[],a=0,l=[],u=Date.now(),f=0;for(let s=0;s<t;s++)i[s]=new Promise(async(t,i)=>{try{for(;e&&a<e.length;){let t=a,i=e[t].args;a++,r.debug(`【${o}】${s} - 执行第${a}个任务，参数【%o】`,i);try{l[t]=await e[t].caller(...i)}catch(e){r.error(`【${o}】${s} - 执行错误，%o`,e)}f++;let c=n(Date.now()-u,f,e.length);r.debug(`【${o}】${s} - 完成第${t+1}个任务！`),r.info(`【${o}】 已经完成${f}/${e.length}个任务，预计还需要时间：${c}`)}t()}catch(e){i(e)}});return i}}));
//# sourceMappingURL=taskqueue.js.map
